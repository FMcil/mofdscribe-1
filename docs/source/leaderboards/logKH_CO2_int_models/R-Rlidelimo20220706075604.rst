Linear regression using polynomial density features
----------------------------------------------------

This baseline uses a simple linear regression on the polynomials up to degree three of the density (as computed using pymatgen).

The model is available in :py:obj:`~mofdscribe.bench.dummy_models.DensityRegressor`

.. code-block:: python

    from typing import Dict, Optional

    import numpy as np
    from pymatgen.core import Structure
    from sklearn.dummy import DummyRegressor as SklearnDummyRegressor
    from sklearn.linear_model import LinearRegression
    from sklearn.pipeline import Pipeline
    from sklearn.preprocessing import PolynomialFeatures, StandardScaler

    class DensityRegressor:
        """Dummy model."""

        def __init__(self, lr_kwargs: Optional[Dict] = None):
            """Initialize the model.

            Args:
                lr_kwargs (Optional[Dict], optional): Keyword arguments
                    that are passed to the linear regressor.
                    Defaults to None.
            """
            self.model = Pipeline(
                [
                    ("scaler", StandardScaler()),
                    ("poly", PolynomialFeatures(degree=3)),
                    ("lr", LinearRegression(**(lr_kwargs or {}))),
                ]
            )

        def featurize(self, s: Structure):
            """You might want to use a lookup in some dataframe instead.

            Or use some mofdscribe featurizers.
            """
            return s.density

        def train(self, idx, structures, y):
            x = np.array([self.featurize(s) for s in structures]).reshape(-1, 1)
            self.model.fit(x, y)

        def predict(self, idx, structures):
            x = np.array([self.featurize(s) for s in structures]).reshape(-1, 1)
            return self.model.predict(x)

Metric card
~~~~~~~~~~~~~~~~~~~

.. regressionmetrics:: linear density
   :id: Rlidelimo20220706075604
   :start_time: 2022-07-06 07:56:04.606088+00:00
   :end_time: 2022-07-06 08:42:57.005975+00:00
   :version: v0.0.1
   :features: density
   :name: linear density
   :task: BenchTaskEnum.logKH_CO2_int
   :model_type: linear regression /w polynomial features
   :reference: mofdscribe
   :implementation: mofdscribe
   :mofdscribe_version: 0.0.1-dev
   :mean_squared_error: 1.14
   :mean_absolute_error: 0.83
   :r2_score: 0.1
   :max_error: 4.0
   :mean_absolute_percentage_error: 0.61
   :top_5_in_top_5: 5
   :top_10_in_top_10: 10
   :top_50_in_top_50: 50
   :top_100_in_top_100: 100
   :top_500_in_top_500: 500
